# Д.З. 10 Написать скрипт на языке Bash;


## Описание
Написать скрипт для CRON, который раз в час будет формировать письмо и отправлять на заданную почту.

Необходимая информация в письме:

Список IP адресов (с наибольшим кол-вом запросов) с указанием кол-ва запросов c момента последнего запуска скрипта;
Список запрашиваемых URL (с наибольшим кол-вом запросов) с указанием кол-ва запросов c момента последнего запуска скрипта;
Ошибки веб-сервера/приложения c момента последнего запуска;
Список всех кодов HTTP ответа с указанием их кол-ва с момента последнего запуска скрипта.
Скрипт должен предотвращать одновременный запуск нескольких копий, до его завершения.

В письме должен быть прописан обрабатываемый временной диапазон.

Прилагается [log-файл](./access-4560-644067.log), который надо обработать.
Для выполнения используется Vagrant, [Vagrantfile](./Vagrantfile) прилагается. В файле устанавливаются необходиые пакеты для работы с почтой, настраивается FQDN сервера и копируются в виртуальную машину файлы [лога](./access-4560-644067.log) и сам [скрипт](./analize.sh).

### Создаем скрипт
Определим переменные

        LOG_FILE="/home/vagrant/access.log"        # Путь к логу
        LOCK_FILE="/tmp/file.lock"                 # Файл блокировки
        LAST_RUN_FILE="/tmp/file_timestamp"        # Файл для хранения времени последнего запуска

Определим способ, которым будем проверять запущен ли скрипт в настоящее время - это существование файла "юлокировки", он будес создаваться в момент запуска скрипта и удаляться при его завершении. В скрипте будем проверять сущесвование этого файла.

        if [ -f "$LOCK_FILE" ]; then
            echo "В настоящее время скрипт уже выполняется."
            exit 1
        else
            touch "$LOCK_FILE"  # Создаем файл блокировки, чтобы предотвратить одновременный запуск
        fi